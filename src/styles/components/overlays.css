/* Overlay (selectors) */
.overlay-backdrop { position:fixed; inset:0; background:rgba(0,0,0,0.55); display:flex; align-items:flex-start; justify-content:center; padding-top:10vh; z-index:1200; }
.overlay-backdrop.centered { align-items:center; padding-top:0; }
.overlay-panel { background:var(--bg-alt); border:1px solid #222; border-radius:6px; min-width:320px; max-width:80vw; max-height:70vh; display:flex; flex-direction:column; font:var(--size-base)/1.4 var(--font-ui); padding-top:6px; }
.overlay-panel header { padding:5px 12px 1px; border-bottom:1px solid #222; font-weight:400; letter-spacing:.2px; font-size:var(--size-base); }
.overlay-panel .list { overflow:auto; }
.overlay-panel ul { list-style:none; margin:0; padding:4px 0; }
.overlay-panel li { padding:4px 10px; cursor:pointer; }
.overlay-panel li.active { background:#1e3a5a; color:#fff; }
.overlay-panel li dim { color:#777; }
.overlay-panel footer { border-top:1px solid #222; padding:8px 12px; display:flex; gap:4px; }
.overlay-panel input[type=text] { flex:1; background:#0a0a0a; border:1px solid #333; color:#eee; padding:4px 6px; font:var(--size-base)/1.4 var(--font-ui); }

/* Topic Picker */
.topic-picker-backdrop { position:fixed; inset:0; background:rgba(0,0,0,0.4); display:flex; align-items:flex-start; justify-content:center; padding-top:14vh; z-index:1300; }
.topic-picker { background:var(--bg-alt); border:1px solid #222; border-radius:6px; width:360px; max-height:60vh; display:flex; flex-direction:column; font:var(--size-base)/1.4 var(--font-ui); }
.topic-picker .tp-search { background:#0c0c0c; border:1px solid #333; color:#eee; padding:6px 8px; margin:8px; border-radius:4px; font:var(--size-base)/1.4 var(--font-ui); }
.topic-picker .tp-tree { overflow:auto; padding:4px 0 8px; padding-left:10px; }
.topic-picker .tp-row { padding:4px 12px; cursor:pointer; display:flex; justify-content:space-between; gap:8px; }
.topic-picker .tp-row.active { background:#1e3a5a; color:#fff; }
.tp-counts { opacity:.55; font-size:11px; }

/* Topic Editor */
.topic-editor-backdrop { position:fixed; inset:0; background:rgba(0,0,0,0.46); display:flex; align-items:flex-start; justify-content:center; padding-top:10vh; z-index:1400; }
.topic-editor { background:var(--bg-alt); border:1px solid #262626; border-radius:8px; width:880px; max-width:92vw; max-height:74vh; display:flex; flex-direction:column; font:var(--size-base)/1.45 var(--font-ui); box-shadow:0 4px 24px rgba(0,0,0,0.5); padding:5px; }
.topic-editor .te-header { padding:8px 12px; font-weight:400; border-bottom:1px solid #222; letter-spacing:.2px; color:var(--text-dim); font-size:var(--size-base); background:var(--bg-alt); }
.topic-editor .te-search { background:#0c0c0c; border:1px solid #333; color:#eee; padding:6px 10px; margin:0 0 8px 0; border-radius:4px; font:var(--size-base)/1.4 var(--font-ui); width:100%; box-sizing:border-box; margin-left:5px; margin-right:5px; width:calc(100% - 10px); }
.topic-editor .te-body { display:grid; grid-template-columns: 1fr 1.1fr; gap:0; min-height:360px; }
.topic-editor .te-left { display:flex; flex-direction:column; border-right:1px solid #222; padding:8px 0 8px 8px; }
.topic-editor .te-tree { flex:1; overflow:auto; padding-right:8px; padding-left:5px; }
.topic-editor .te-details { display:flex; flex-direction:column; padding:12px 14px; gap:10px; }
.topic-editor .te-path { color:var(--text-dim); font-size:var(--size-base); letter-spacing:.2px; padding:2px 0 6px; }
.topic-editor .te-field { display:flex; flex-direction:column; gap:6px; }
.topic-editor .te-field label { color:var(--text-dim); font-size:var(--size-base); letter-spacing:.25px; }
.topic-editor .te-textarea { background:#060606; border:1px solid #333; color:#eee; padding:8px 10px; border-radius:4px; resize:vertical; min-height:96px; max-height:240px; font:var(--size-base)/1.45 var(--font-ui); }
.topic-editor .te-actions { display:flex; gap:8px; margin-top:5px; }
.topic-editor .te-btn { background:var(--btn-bg); color:var(--text); border:1px solid var(--btn-border); padding:9px 13px; border-radius:4px; cursor:pointer; font:12px var(--font-ui); transition:background .15s, border-color .15s; }
.topic-editor .te-btn:hover, .topic-editor .te-btn:focus { background:var(--btn-bg-hover); border-color:#444; }
.topic-editor .te-primary-actions { display:flex; gap:8px; justify-content:flex-end; margin-top:4px; }
.topic-editor .te-grid { display:grid; grid-template-columns: 1fr 1fr; gap:10px 12px; }
.topic-editor .te-input { background:#060606; border:1px solid #333; color:#eee; padding:6px 8px; border-radius:4px; font:var(--size-base)/1.4 var(--font-ui); }
.topic-editor .te-hint { color:var(--text-dim); font-size:var(--size-base); letter-spacing:.2px; }
.topic-editor .te-status { margin-top:auto; padding-top:6px; color:var(--text-dim); font-size:var(--size-base); display:flex; justify-content:space-between; align-items:center; border-top:1px solid #222; min-height:1.45em; white-space:nowrap; }
.topic-editor .te-row { padding:3px 12px 3px 12px; cursor:default; white-space:nowrap; font:var(--size-base)/1.45 var(--font-ui); display:flex; align-items:center; gap:6px; font-weight:400; }
.topic-editor .te-marker { display:inline-block; width:1.25em; text-align:center; font-size:16px; line-height:1; }
.topic-editor .te-row.active { background:#1e3a5a; color:#fff; }
.topic-editor .te-row.marked { background:var(--marked-bg); color:#d2f2e0; }
.topic-editor .te-row.active.marked { background:#195a82; }
.topic-editor .te-row.creating { background:#142636; }
.topic-editor .te-row input.te-edit { background:#060606; border:1px solid #444; color:#eee; padding:2px 4px; font:var(--size-base)/1.3 var(--font-ui); border-radius:3px; min-width:220px; }
.topic-editor .te-row input.te-edit:focus { border-color:var(--accent); }
.topic-editor .te-counts { margin-left:auto; opacity:.5; font-size:11px; }
.topic-editor .te-warning { min-height:20px; padding:4px 10px 6px; font:11px/1.4 var(--font-ui); color:#f88; border-top:1px solid #222; opacity:0; transition:opacity .2s; letter-spacing:.3px; }
.topic-editor .te-tree:focus { outline:none; }
.topic-editor .te-warning.visible { opacity:1; }

/* Help overlay */
.help-panel { width:1320px; max-width:98vw; box-sizing:border-box; overflow:hidden; }
.help-panel .help-body { padding:14px 18px 12px; display:flex; flex-direction:column; gap:12px; font:var(--size-base)/1.45 var(--font-ui); color:var(--text); overflow:auto; }
.help-panel .help-body { font-size: clamp(12px, 1.5vw, var(--size-base)); }
.help-panel .help-body section { font-weight:400; letter-spacing:.2px; }
.help-panel .help-body strong { font-weight:500; color: var(--text); }

.help-grid { display:grid; grid-template-columns: 1.15fr 1.05fr 1.35fr 1.45fr; gap:16px 20px; align-items:start; }
.help-col { display:grid; grid-template-columns:auto 1fr; column-gap:16px; row-gap:8px; align-content:start; border:1px solid var(--border); border-radius:6px; padding:8px; background:transparent; }
.help-title { grid-column:1 / -1; font-weight:400; color:var(--text-dim); margin-bottom:4px; }
.help-subtitle { grid-column:1 / -1; margin:0; font-size:inherit; color:var(--text-dim); }
.help-k { color:var(--text); background:transparent; border:none; border-radius:0; padding:0; line-height:1.45; white-space:nowrap; }
.help-d { color:var(--text-dim); }

@media (max-width:1040px){ .help-panel{ width:96vw; } .help-panel .help-body{ font-size: clamp(11px, 1.2vw, var(--size-base)); } .help-grid{ gap:14px 14px; } .help-col{ column-gap:14px; } }
@media (max-width:1000px){ .help-grid{ grid-template-columns: repeat(2, 1fr); } }
@media (max-width:720px){ .help-grid{ grid-template-columns: 1fr; } }
@media (max-height:820px){ .help-panel .help-body{ font-size: clamp(11px, 1.3vh, var(--size-base)); } }
.help-panel .help-hint { font-size:11px; opacity:.6; letter-spacing:.4px; }
.help-panel .help-buttons { display:flex; justify-content:flex-end; gap:8px; margin-top:4px; }

/* Menu overlay variant: backdrop for app menu (non-centered, anchored to button) */
.overlay-backdrop.menu-overlay {
	align-items: flex-start;
	justify-content: flex-start;
	padding-top: 0; /* menu is absolutely positioned; no padding needed */
}

.overlay-backdrop.menu-overlay .app-menu {
	position: absolute; /* will be positioned by JS via left/top */
	top: 0;
	left: 0;
	z-index: 1300; /* above base content; backdrop is behind */
	display: inline-block; /* avoid stretching to full width */
	width: auto; /* shrink-to-fit content */
	max-width: 320px; /* reduced per request */
}
